<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>atari sound forger</title>
        <link rel="stylesheet" href="styles.css" />
    </head>
    <body>
        <script src="./Pizzicato.min.js"></script>
        <script src="defaultMaps.js"></script>
        <script src="templateBas.js"></script>
        <script src="asf.js"></script>

        <div class="content">
            <h1>Atari Sound Forger (v0.5 alpha)</h1>


            <details>
                <summary>About</summary>
            <p>
                This is meant as a fun real-time tool for exploring Atari 2600 Sounds.
            </p>
            <p>
                Using "mapping sets", standard atari voices are mapped to the computer keyboard, 
                allowing quick play as with a regular synth keyboard.
            </p>
            <p>
                Some mapping sets draw from different Atari voices, and some will display a mapping 
                to the a "regular" piano keyboard when available. (Tuning the Atari is a tricky thing :-) )
            </p>
            <p>
                You can create your own mapping sets as well.
            </p>
            <p>
                Future plans include recording timing information and generating batari Basic samples.
            </p>
        </details>
            <pre id="log"></pre>

            <label
                >Current Mapping Set:
                <select id="mapSelect" onchange="setupSelectedMap()"></select
            ></label>

            
<div keyWrapper tabindex="0">
            <div class="piano" id="pianoWrapper"></div>
            <div id="keyboardWrapper"></div>
</div>
            <button onclick="stopAllSounds()">stop all sounds</button>

            <details open>
                <summary>Recording</summary>
                
                <h3>Loops</h3>

                <div style="display:flex">
                    <button id="toggleRecording" onclick="toggleRecording()">â—‰ start recording</button>
                    <div><label><input id="useClickTrack" type="checkbox" checked>Include Click Track </label><br> &nbsp;&nbsp;&nbsp;&nbsp;[<span id="bpm">120</span>bpm : <span id="fpc">30</span> frames per beat] <a href="#" onclick="promptBPM(); return false;">change</a></div>
                </div>

                 <div id="recordingStatus"></div>


                

                <div id="loopWrapper"></div>
                
                
                <br>
                
                
                <button id="playback" onclick="togglePlayBack()"></button>
                <br><br>
                
                <h3>batari Basic code</h3>
                <textarea id="basicTextarea"></textarea>
                <button onclick="generateBasic()">generate batariBasic code</button><button onclick="copyBasicToClipboard()">copy code to clipboard</button>
                
            </details>    



            

            <details>
                <summary>Advanced Tools</summary>
                <h3>Mapping Sets</h2>
                <p>
                    Mapping Sets are arrays of JSON
                    


                    and pretty straightforward:
                    <pre>
                        desc - description
                        keyboard - currently ignored, set to 'us' for now
                        key2tfm - an map of keyboard keys to Atari tone, frequency, and piano note
                                  (note, octave, then maybe sharp, i.e. e2 or f3# )
                                  (piano note for display purposes only...)

                    </pre>
                </p>
                    If you edit here and hit "Store and Use Mapping Sets", it is saved to Local Storage,
                    so if you make something cool you may want to copy and paste it to someplace safe.
                </p>
                <h4>Current Mappings</h4>
                <textarea id="mappingsets"></textarea>
            </br>
                <button onclick="storeMappingSetsAndReload()">Store and Use Mapping Sets</button> 
                <button class="button-as-link" onclick="restoreDefaultMappings()">Restore Defaults</button>
                
                <p>(warning: / key leads to bad results on Firefox)</p>
            </details>

            <details>
                <summary>Acknowledgements</summary>
                <p>
                    Admittedly I think these are all using NTSC values.
                </p>
                <p>
                    This work relies heavily on other people in the Atari dev community, especially
                    <a href="https://www.randomterrain.com/">Random Terrain</a>
                    who allowed me to use the Atari 2600 sound clips he painstakingly recorded.
                </p>
                <p>
                    Many of the ideas here were first shown in Visual batari Basic and rely on
                    <a href="https://www.randomterrain.com/atari-2600-memories-music-and-sound.html#freq_wav_guide"
                        >Eckhard Stolberg's work</a
                    >.
                </p>
                <p>
                    Using <a href="https://alemangui.github.io/pizzicato/">Pizzicato.js</a> as the webkit sound library.
                </p>
                <p>
                    Source code open for pull requests at
                    <a href="https://github.com/kirkjerk/atari-sound-forger">github.com/kirkjerk/atari-sound-forger</a>
                </p>
            </details>
        </div>
    </body>
</html>
